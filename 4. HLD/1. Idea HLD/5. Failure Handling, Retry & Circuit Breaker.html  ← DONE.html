<!-- 
====================================================================================================
5ï¸âƒ£ FAILURE HANDLING & RETRIES (VERY IMPORTANT)
====================================================================================================

Failures can happen at ANY layer.

----------------------------------------------------------------------------------------------------
ðŸ“Œ FAILURE DECISION RULES
----------------------------------------------------------------------------------------------------

DNS LEVEL:
----------
- If region DOWN â†’ choose next best region

L4 LEVEL:
---------
- If server fails â†’ retry on another server

L7 LEVEL:
---------
- If service returns 5xx â†’ retry (if safe)

SERVICE LEVEL:
--------------
- Timeout â†’ retry
- Circuit breaker opens â†’ stop sending traffic

----------------------------------------------------------------------------------------------------
ðŸ“Š FAILURE FLOW
----------------------------------------------------------------------------------------------------

Request
 â†“
Failure detected âŒ
 â†“
Is retry safe?
 â†“
Yes â†’ Retry next instance
No  â†’ Return error
 -->


<!--
====================================================================================================
5ï¸âƒ£ FAILURE HANDLING, RETRY & CIRCUIT BREAKER
====================================================================================================

ðŸ“Œ PURPOSE OF THIS STAGE
----------------------------------------------------------------------------------------------------
Handle failures gracefully and keep the system:
âœ” Available
âœ” Stable
âœ” Resilient

Failures are EXPECTED in distributed systems.

====================================================================================================
ðŸ“ WHERE FAILURE HANDLING EXISTS
====================================================================================================

Failure handling logic exists at MULTIPLE LEVELS:
âœ” Client (browser / mobile app)
âœ” API Gateway / L7 Load Balancer
âœ” Service Layer
âœ” Message consumers (async)

There is NO single failure-handling place.

====================================================================================================
â“ QUESTIONS THIS STAGE ANSWERS
====================================================================================================

ðŸ‘‰ What if a request fails?
ðŸ‘‰ Should we retry?
ðŸ‘‰ When should we stop retrying?
ðŸ‘‰ How to prevent cascading failures?

====================================================================================================
ðŸ” RETRY MECHANISM
====================================================================================================

Retry means:
-------------
ðŸ‘‰ Trying the same request again after a failure

Common retry triggers:
----------------------
- Timeout
- Network error
- 5xx server error

âŒ Do NOT retry on:
------------------
- 4xx client errors
- Invalid requests

--------------------------------------------------
ðŸ“Œ SAFE RETRY RULE
--------------------------------------------------
âœ” Only retry IDEMPOTENT operations
Example:
- GET âœ”
- PUT âœ”
- POST âŒ (usually)

====================================================================================================
â±ï¸ RETRY STRATEGIES
====================================================================================================

1ï¸âƒ£ IMMEDIATE RETRY
-------------------
- Retry instantly
- Risk: traffic spike

2ï¸âƒ£ FIXED DELAY
---------------
- Retry after fixed time

3ï¸âƒ£ EXPONENTIAL BACKOFF (BEST PRACTICE)
---------------------------------------
- Retry after: 1s â†’ 2s â†’ 4s â†’ 8s
- Prevents overload

====================================================================================================
ðŸš¨ CIRCUIT BREAKER
====================================================================================================

Circuit Breaker prevents repeated failures.

STATES:
-------
1ï¸âƒ£ CLOSED
- Requests flow normally

2ï¸âƒ£ OPEN
- Too many failures
- Requests blocked immediately

3ï¸âƒ£ HALF-OPEN
- Limited test requests allowed
- If success â†’ CLOSE
- If fail â†’ OPEN again

--------------------------------------------------
ðŸ“Š CIRCUIT BREAKER FLOW
--------------------------------------------------

Request
  â†“
Failure count exceeds threshold
  â†“
Circuit OPEN âŒ
  â†“
Requests blocked
  â†“
Wait time expires
  â†“
HALF-OPEN (test)
  â†“
Success â†’ CLOSED
Failure â†’ OPEN

====================================================================================================
ðŸ§  WHY CIRCUIT BREAKER IS IMPORTANT
====================================================================================================

âœ” Prevents cascading failures
âœ” Protects downstream services
âœ” Improves overall system stability

====================================================================================================
ðŸ§  WHAT THIS STAGE DOES NOT DO
====================================================================================================

âŒ Does NOT fix bugs
âŒ Does NOT guarantee success
âŒ Does NOT replace proper monitoring

====================================================================================================
ðŸ§  FINAL MEMORY TRICK
====================================================================================================

Retry = Try again  
Backoff = Try slowly  
Circuit Breaker = Stop trying  

====================================================================================================
ðŸŽ¤ INTERVIEW-SAFE ONE-LINER
====================================================================================================

â€œFailures are handled using retries with backoff and circuit breakers to prevent cascading
failures and maintain system stability.â€

====================================================================================================
END OF FAILURE HANDLING STAGE
====================================================================================================
-->
