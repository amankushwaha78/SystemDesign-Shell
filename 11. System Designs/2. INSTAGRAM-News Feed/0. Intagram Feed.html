

<!-- 
    Instagram News Feed System Design: Optimized Microservices Architecture

                            ┌────────────────────────────────────────────┐
                            │              API Gateway (Nginx)           │
                            └────────────────────────────────────────────┘
                                                ⬇
    ┌───────────────────────────────────────────────────────────────────────────────────────────┐
    │                                      Microservices Layer                                  │
    ├───────────────────────────────────────────────────────────────────────────────────────────┤
    │                                                                                           │
    │   ┌────────────────────────┐     ┌────────────────────────┐     ┌────────────────────────┐│
    │   │  User Service          │     │  Post Service          │     │  Engagement Service    ││
    │   │  (Profiles, Auth)      │     │  (Upload, Media)       │     │  (Likes, Comments)     ││
    │   │  [OAuth, JWT]          │     │  [Cloudinary, S3]      │     │  [MySQL Triggers]      ││
    │   │                        │     │                        │     │                        ││
    │   │  ┌──────────────────┐  │     │  ┌──────────────────┐  │     │  ┌──────────────────┐  ││
    │   │  │  PostgreSQL      │  │     │  │  MongoDB         │  │     │  │  MySQL           │  ││
    │   │  └──────────────────┘  │     │  └──────────────────┘  │     │  └──────────────────┘  ││
    │   └────────────────────────┘     └────────────────────────┘     └────────────────────────┘│
    │                                                                                           │
    │   ┌────────────────────────┐     ┌────────────────────────┐     ┌────────────────────────┐│
    │   │  Follower Service      │     │  Feed Service          │     │  Recommendation Service││
    │   │  (Follow/Unfollow)     │     │  (News Aggregation)    │     │  (AI-based Ranking)    ││
    │   │  [Graph Algorithms]    │     │  [Kafka, Spark]        │     │  [ML, TensorFlow]      ││
    │   │                        │     │                        │     │                        ││
    │   │  ┌──────────────────┐  │     │  ┌──────────────────┐  │     │  ┌──────────────────┐  ││
    │   │  │  Neo4j           │  │     │  │  Cassandra       │  │     │  │  Neo4j           │  ││
    │   │  └──────────────────┘  │     │  └──────────────────┘  │     │  └──────────────────┘  ││
    │   └────────────────────────┘     └────────────────────────┘     └────────────────────────┘│
    │                                                                                           │
    │   ┌────────────────────────┐                                                              │
    │   │  Cache Service         │                                                              │
    │   │  (Fast Retrieval)      │                                                              │
    │   │  [Redis Clustering]    │                                                              │
    │   │                        │                                                              │
    │   │  ┌──────────────────┐  │                                                              │
    │   │  │  Redis           │  │                                                              │
    │   │  └──────────────────┘  │                                                              │
    │   └────────────────────────┘                                                              │
    │                                                                                           │
    └───────────────────────────────────────────────────────────────────────────────────────────┘
                                            ⬇
    ┌───────────────────────────────────────────────────────────────────────────────────────────┐
    │                                  Background Processing & Event Handling                   │
    ├───────────────────────────────────────────────────────────────────────────────────────────┤
    │                                                                                           │
    │   ┌───────────────────────────────────────────────────────────────────────────────────┐   │
    │   │                                  Kafka (Event Streaming)                          │   │
    │   └───────────────────────────────────────────────────────────────────────────────────┘   │
    │                                                                                           │
    │   ┌─────────────────────────────┐     ┌──────────────────────────────┐                    │
    │   │ AI Moderation Service       │     │  Analytics Engine            │                    │
    │   │ (Content filtering, Safety) │     │ (User behavior insights)     │                    │
    │   │ [OpenAI API, TensorFlow]    │     │ [BigQuery, Apache Flink]     │                    │
    │   └─────────────────────────────┘     └──────────────────────────────┘                    │
    │                                                                                           │
    └───────────────────────────────────────────────────────────────────────────────────────────┘
                                           ⬇
    ┌───────────────────────────────────────────────────────────────────────────────────────────┐
    │                                   Push Notification Service                               │
    ├───────────────────────────────────────────────────────────────────────────────────────────┤
    │                                                                                           │
    │   ┌───────────────────────────┐     ┌───────────────────────-────┐                        │
    │   │ Firebase Cloud Messaging  │     │  Amazon SNS / Twilio       │                        │
    │   │ (Mobile notifications)    │     │  (SMS & Push notifications)│                        │
    │   │ [WebSockets, Pub/Sub]     │     │ [Lambda Functions]         │                        │
    │   └───────────────────────────┘     └────────────────────────-───┘                        │
    │                                                                                           │
    └───────────────────────────────────────────────────────────────────────────────────────────┘

    -->
