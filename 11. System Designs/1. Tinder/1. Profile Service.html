<!--  
ðŸ”‘ 1ï¸âƒ£ User Authentication & Profile Creation :
------------------------------------------------
ðŸ”¹ Services Involved:  
    âœ… API Gateway (Nginx : Reverse Proxy + Load Balancer) â€“ Routes requests to the correct microservice.  
    âœ… Profile Service â€“ Manages user authentication(OAuth, JWT validation) and profile creation.
    âœ… Session Service â€“ Handles user sessions.

    ðŸ“Œ Client Requests Flow :-
    -------------------------
    1ï¸âƒ£ Client (Mobile/Web App) â†’ API Gateway (Nginx/Kong)
        SO First we click login in via Mobile/Web app.
        DNS converts the Domain name into IP address.

    2ï¸âƒ£ Than API Gateway forwards the request to Authentication Service (here aka Profile Service).
        Here we will use Nginx API Gateway.
        It provides support of "Reverse proxy and Load Balancer".

    2ï¸âƒ£ Inside Authentication Service (here aka Profile Service) we will use OAuth 2.0 for social logins.
        The user opens Tinder and clicks on â€œContinue with Googleâ€ / â€œContinue with Facebookâ€ / â€œContinue with Appleâ€.
        If the user clicks â€œContinue with Googleâ€, Tinder redirects them to Googleâ€™s login page.

        A. The OAuth provider(here Google) authenticates the user and asks for permission:
                i).  Access to email, profile data.
                ii). Permission to share data with Tinder.
           Note : Tinder does not see the password. Only Google (or the chosen provider) handles authentication.

        B. After filling data OAuth provider sends a one-time authorization code to Tinder Backend Server.
           This is a temporary, one-time code (used only once).
                 {
                       "code": "4/yFAGM...dB"               => To Tinder By Google
                 }

        C. Once Tinder Backend Server receives the Authorization Code from Google.
           Tinderâ€™s backend sends the code to Google/Facebook with its client credentials (Client ID & Secret).
                 {
                        client_id=CLIENT_ID
                        &client_secret=CLIENT_SECRET
                        &code=4/yFAGM...dB                  => To Google By Tinder
                        &grant_type=authorization_code
                 }
 
         D. Google Again Sends a responds To Tinder Server with an Access Token.

                 {
                        "access_token": "ya29.a0AR...",     => To Tinder By Google
                        "id_token": "eyJhbGciOiJIUzI1...",
                        "expires_in": 3600
                 }

         E. Tinder validates the received JWT token using its API Gateway.
            The decoded token contains user details:
                 {
                        "sub": "123456789",
                        "email": "user@gmail.com",
                        "name": "John Doe",
                        "picture": "https://profile-pic.jpg"
                 }
    
            Tinder Backend Server stores the JWT token in the database and creates a new session for the user.
            Tinder Backend Server will send this Token to client Laptop.

         F. Client sends JWT in the Authorization header on every request :
                  GET /user/profile
                  Authorization: Bearer <JWT_TOKEN>

            Server verifies JWT using a secret key and grants access.
            This Access Token is Needed for User Data
                a. The Access Token is what allows Tinder to fetch user details (like name, email, and profile pic).
                b. Without it, Tinder cannot authenticate the user properly.


    3ï¸âƒ£ Once Tinder receives a valid JWT token from Google/Facebook/Apple, it must determine whether the user is:
            ðŸ†• New User â†’ Needs to create a profile
            ðŸ  Existing User â†’ Fetches their saved profile 

        a. find Email address from The decoded JWT token :
              {
                    "sub": "123456789",
                    "email": "newuser@gmail.com",
                    "name": "John Doe",
                    "picture": "https://profile-pic.jpg"
              }
        b. Tinder queries the database to check if the email exists.
           SELECT * FROM users WHERE email = 'aman@gmail.com';

           If no match found, it's a new user :
           ----------------------------------
           i). Redirect to Profile Creation Page :
               Tinder UI inputs the user to set up their profile:
                âœ… Name
                âœ… Profile Picture
                âœ… Gender & Preferences
                âœ… Location

           If found, itâ€™s an existing user :
           ----------------------------------
           i). Tinder retrieves the profile and sends it back to the frontend.
               {
                "name": "Alice Smith",
                "profile_pic": "https://profile-pic.jpg",
                "bio": "Love adventures â¤ï¸",
                "preferences": { "age_range": "21-30", "gender": "Male" }
               }

    3ï¸âƒ£ Upon success, the user gets logged in and redirected to the dashboard.
    4ï¸âƒ£ Session Service stores session data (it also saves its Token ) in "Redis" for quick authentication.
        Ques :What Happens When a User Returns to Tinder the Next Day?
        Ans : Step 1: Check for an Existing JWT Token :
                      a. Local Storage (Web)
                      b. Secure Storage (AsyncStorage, Keychain, etc.) (Mobile)
                      c. Cookies (For web sessions with HTTP-only cookies)

              Step 2 : If a token exists, the app sends it to the backend for verification:
                      ðŸ”¹ Backend verifies:
                      a. Token is not expired
                      b. Token signature is valid
                      c. User exists in the database

             If all are valid redirect to homepage. else redirect to login Page.
          
    5ï¸âƒ£ Microservices send response â†’ API Gateway â†’ Client
-->  


<!-- 

### **ðŸ”¹ Interview Questions & Answers on OAuth-based Authentication in Tinder**  

*ðŸ”¸ Basic Questions on OAuth & API Gateway**  

Que.1ï¸âƒ£ What is the role of the API Gateway in user authentication?**  
Ans.âœ… The API Gateway (like **Nginx** or **Kong**) acts as a **reverse proxy and load balancer**.  
    âœ… It routes login requests to **authentication service**.  
    âœ… It also handles **security, rate limiting, and token validation** before passing the request to microservices.  


Que.2ï¸âƒ£ What is OAuth 2.0, and how does it work in Tinder login?**  
Ans.âœ… **OAuth 2.0** is an **authorization framework** used for **secure login** without sharing passwords.  
    âœ… In Tinder, when a user logs in via **Google/Facebook/Apple**, 
        OAuth helps **verify identity** and get user details (like email & profile picture).  

    ðŸ”¹ Steps in OAuth login (Tinder using Google) :  
    1ï¸âƒ£ User clicks **"Continue with Google"**.  
    2ï¸âƒ£ Tinder redirects to Googleâ€™s login page.  
    3ï¸âƒ£ User enters credentials; Google **asks for permission**.  
    4ï¸âƒ£ Google sends an **Authorization Code** to Tinder. 
        Tinderâ€™s backend sends this code again to Google with its client credentials (Client ID & Secret).
    5ï¸âƒ£ Now google sends **Access Token** To Tinder.  
    6ï¸âƒ£ Tinder uses the **Access Token** to fetch the userâ€™s email & profile details.  


Que.3ï¸âƒ£ Why does Tinder use OAuth instead of asking for a password?**  
Ans.âœ… OAuth allows **secure authentication** without exposing passwords.  
    âœ… Tinder never **stores or handles passwords**; Google/Facebook does.  
    âœ… OAuth tokens expire, reducing security risks compared to stored passwords.  


Que.4ï¸âƒ£ What is JWT (JSON Web Token), and why is it used?**  
Ans.âœ… **JWT is a secure way to authenticate users.**  
    âœ… It contains **user details (email, profile, permissions, etc.)** inside an encrypted token.  
    âœ… Tinder **stores JWT** on the client side and **sends it in every API request** for authentication.  

--------------------------------------
ðŸ”¸ Questions on Authentication Flow :  
--------------------------------------

Que.5ï¸âƒ£ How does Tinder verify a returning user the next day?**  
Ans.âœ… When a user opens Tinder tomorrow, the app **checks for a stored JWT token**.  
    âœ… If a token exists, Tinder sends it to the backend to **verify its validity**.  
    âœ… If the token is valid, Tinder logs in the user automatically.  
    âœ… If the token is expired or invalid, the user is asked to **log in again**.  


Que.6ï¸âƒ£ Where does Tinder store the JWT token on different devices?**  
Ans.ðŸ“Œ **Web:** Cookies (with HTTP-only & Secure flags) or Local Storage.  
    ðŸ“Œ **Mobile Apps (Android/iOS):** Secure Storage (Keychain for iOS, Encrypted Storage for Android).  


Que.7ï¸âƒ£ How does Tinder prevent fake logins with JWT?**  
Ans.âœ… JWT tokens are **signed with a secret key**, preventing modification.  
    âœ… The backend **verifies JWT signature** before granting access.  
    âœ… JWT **expiration time** limits how long a token remains valid.  

Que.8ï¸âƒ£ How does Tinder handle session management?**  
Ans.âœ… The **Session Service** in Tinder stores session data in **Redis** for fast access.  
    âœ… If a user logs out, the session is deleted from Redis.  
    âœ… When a user logs in again, a **new session is created** with a fresh JWT.  


Que.9ï¸âƒ£ What happens if the JWT token is stolen?**  
Ans.âœ… Attackers can **impersonate** the user if they steal the JWT.  
    âœ… Tinder mitigates this by:  
    - Using **short-lived JWTs** (expire quickly).  
    - Implementing **refresh tokens** for re-authentication.  
    - Storing JWT in **secure storage** instead of Local Storage.  

-------------------------------------------
ðŸ”¸ Advanced Questions on OAuth & Security :
-------------------------------------------

Que. ðŸ”Ÿ How does Tinder refresh the login session without re-entering credentials?**  
Ans. âœ… Tinder **stores a refresh token** (a long-lived secret key).  
     âœ… When the JWT expires, Tinder uses the **refresh token** to request a **new JWT**.  
     âœ… This allows **silent re-login** without asking for credentials again.  


Que.1ï¸âƒ£1ï¸âƒ£ Why is OAuth better than session-based authentication?**  
Ans.âœ… **Scalability** â€“ OAuth **does not rely on server-side sessions**, making it ideal for microservices.  
    âœ… **Security** â€“ Passwords are never stored; authentication happens via access tokens.  
    âœ… **Flexibility** â€“ Users can log in using different **identity providers (Google, Facebook, Apple, etc.)**.  


Que.1ï¸âƒ£2ï¸âƒ£ How does Tinder prevent brute-force attacks on login?**  
Ans.âœ… **Rate limiting** via API Gateway (**Nginx/Kong**) to block repeated failed login attempts.  
    âœ… **CAPTCHA verification** if multiple failed attempts occur.  
    âœ… **Account lockout policy** after too many failed login attempts.  


Que.1ï¸âƒ£3ï¸âƒ£ What if a user logs in from multiple devices?**  
Ans.âœ… Each device gets a **separate session with its own JWT token**.  
    âœ… Sessions are stored in Redis, so the backend knows all active logins.  
    âœ… Tinder can **invalidate all sessions** when a user logs out from all devices.  


Que.1ï¸âƒ£4ï¸âƒ£ What happens if a user revokes Google/Facebook access?**  
Ans.âœ… Google/Facebook will **invalidate the access token**.  
    âœ… Tinder will detect this when the userâ€™s token **fails verification**.  
    âœ… The user will be asked to **log in again** with a new OAuth flow.  


Que.1ï¸âƒ£5ï¸âƒ£ How does Tinder ensure OAuth security?**  
Ans.âœ… Uses **PKCE (Proof Key for Code Exchange)** to prevent token theft.  
    âœ… Stores OAuth **secrets securely** in environment variables (not hardcoded in code).  
    âœ… Uses **OAuth scopes** to limit data access (e.g., only fetch email & profile picture).  


## **ðŸ”¹ Summary of Key Takeaways**  

âœ… **OAuth 2.0** allows secure login via Google/Facebook/Apple.  
âœ… **JWT tokens** authenticate users & prevent password sharing.  
âœ… **Session Service (Redis)** manages active user sessions.  
âœ… **API Gateway (Nginx/Kong)** handles authentication, security, and routing.  
âœ… **Secure Storage** (Keychain, Cookies, LocalStorage) stores tokens safely.  
-->


<!--
Q. ðŸ” Authentication (Signup & Login) :
---------------------------------------
    ðŸ”¹ Do we support third-party authentication (Google, Facebook, Apple)?
    ðŸ‘‰ Yes, OAuth 2.0 is widely used for social logins. 
        It enhances user convenience but needs security checks (like token validation).

    ðŸ”¹ How do we handle account recovery & security measures?
    ðŸ‘‰ Typically via email/phone OTPs. 
        For extra security, we can use 2FA (two-factor authentication).

    ðŸ”¹ What kind of rate-limiting or bot protection is in place?
    ðŸ‘‰ reCAPTCHA for bot detection,
        JWT token expiration,
        and IP-based rate limiting (e.g., max 5 login attempts per minute).
-->